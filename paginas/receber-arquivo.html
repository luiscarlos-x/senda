<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../css/image/senda.png">
    <title>Receber Arquivo - Senda</title>
    <meta name="description" content="Receba arquivos de clientes de forma instantânea">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/receive-file.css">
    <script src="../javascript/theme.js"></script>
    <!-- Socket.io Client -->
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <!-- QR Code library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo" onclick="window.location.href='/'">
                <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 5L35 15V25L20 35L5 25V15L20 5Z" stroke="url(#logo-gradient)" stroke-width="2"
                        fill="url(#logo-fill)" />
                    <circle cx="20" cy="20" r="6" fill="white" />
                    <defs>
                        <linearGradient id="logo-gradient" x1="5" y1="5" x2="35" y2="35">
                            <stop offset="0%" stop-color="#5F6F52" />
                            <stop offset="100%" stop-color="#A4B494" />
                        </linearGradient>
                        <linearGradient id="logo-fill" x1="5" y1="5" x2="35" y2="35">
                            <stop offset="0%" stop-color="#5F6F52" stop-opacity="0.3" />
                            <stop offset="100%" stop-color="#4A5842" stop-opacity="0.1" />
                        </linearGradient>
                    </defs>
                </svg>
                <span class="logo-text">Senda</span>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Alternar tema">
                <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
                </svg>
                <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5" />
                    <line x1="12" y1="1" x2="12" y2="3" />
                    <line x1="12" y1="21" x2="12" y2="23" />
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                    <line x1="1" y1="12" x2="3" y2="12" />
                    <line x1="21" y1="12" x2="23" y2="12" />
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                </svg>
            </button>
        </header>

        <main class="receive-main">
            <div class="session-container">
                <!-- Simple Header -->
                <div class="session-header-simple">
                    <button class="back-home-button" onclick="window.location.href='index.html'">
                        <svg viewBox="0 0 20 20" fill="currentColor">
                            <path
                                d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                        </svg>
                        Voltar ao início
                    </button>
                </div>

                <div class="session-content">
                    <!-- Waiting State -->
                    <div class="session-state active" id="waitingState">
                        <h2 class="session-title">Receber Arquivo</h2>
                        <p class="session-subtitle">Gere um QR Code para o cliente enviar documentos</p>

                        <button class="generate-button" onclick="generateSession()">
                            <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="8" y="8" width="20" height="20" stroke="currentColor" stroke-width="2"
                                    rx="2" />
                                <rect x="12" y="12" width="12" height="12" fill="currentColor" />
                                <rect x="36" y="8" width="20" height="20" stroke="currentColor" stroke-width="2"
                                    rx="2" />
                                <rect x="40" y="12" width="12" height="12" fill="currentColor" />
                                <rect x="8" y="36" width="20" height="20" stroke="currentColor" stroke-width="2"
                                    rx="2" />
                                <rect x="12" y="40" width="12" height="12" fill="currentColor" />
                                <path
                                    d="M36 36H44M36 40H44M36 44H44M48 36H56M48 40H56M48 44H56M36 48H44M36 52H44M48 48H56M48 52H56M52 56H56"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>Gerar QR Code e Código</span>
                        </button>
                    </div>

                    <!-- Active Session State -->
                    <div class="session-state" id="activeSessionState">
                        <div class="session-info-badge">
                            <svg viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                                    clip-rule="evenodd" />
                            </svg>
                            <span>Sessão ativa - Aguardando arquivo</span>
                        </div>

                        <div class="qr-code-section">
                            <h3 class="qr-title">Cliente pode escanear ou digitar o código</h3>

                            <div class="qr-display">
                                <div class="qr-code-wrapper">
                                    <div id="qrcode" class="qr-code"></div>
                                </div>

                                <div class="code-display">
                                    <div class="code-label">Código de 4 dígitos</div>
                                    <div class="code-value" id="sessionCode">----</div>
                                    <button class="code-copy-button" onclick="copyCode()">
                                        <svg viewBox="0 0 20 20" fill="currentColor">
                                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                                            <path
                                                d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                                        </svg>
                                        Copiar código
                                    </button>
                                </div>
                            </div>
                        </div>

                        <button class="end-session-button" onclick="endSession()">
                            <svg viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                                    clip-rule="evenodd" />
                            </svg>
                            Encerrar sessão
                        </button>
                    </div>

                    <!-- File Received State -->
                    <div class="session-state" id="fileReceivedState">
                        <div class="success-icon">
                            <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="32" cy="32" r="28" stroke="currentColor" stroke-width="3" />
                                <path d="M20 32L28 40L44 24" stroke="currentColor" stroke-width="4"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <h2 class="success-title" id="receivedFileCount">Arquivo recebido!</h2>
                        <p class="success-subtitle">O cliente enviou os arquivos com sucesso</p>

                        <!-- Dynamic file list -->
                        <div class="received-files-list" id="receivedFilesList"></div>

                        <div class="file-actions">
                            <button class="new-session-button" onclick="newSession()">
                                <svg viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd"
                                        d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                                        clip-rule="evenodd" />
                                </svg>
                                Nova sessão
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>&copy; 2026 Senda. Todos os direitos reservados.</p>
        </footer>
    </div>

    <script src="../javascript/script.js"></script>
    <script src="../javascript/receive-file.js"></script>
</body>

</html>